{
    "contents" : "\nlibrary(ggplot2)\nlibrary(plyr)\nlibrary(dplyr)\n\nsource('SET_ABSOLUTE_PATH.R')\n\ndatadir <- file.path(PROJHOME, 'Raw Data/5-AZA/extractedCSV/')\noutSelectdir <- file.path(PROJHOME, 'Plots/Figure 4/')\n\nmaster <- data.frame()\n#colnames(master) <- c(\"objArrayNum\",\"objNum\",\"isGood\", \"AllelicExpression\", \"area\", \"alexa.RNACounts\", \"isTreated\", \"Genotype\", \"RepID\")\n\nfilenames <- list.files(path = datadir)\n\nfor (expName in filenames){\n  split <- strsplit(expName, \"_\")\n  toJoin <- read.csv(paste(datadir, expName, sep = \"\"))\n  toJoin$isTreated <- split[[1]][1] == \"Drug\"\n  toJoin$Genotype <- split[[1]][2]\n  toJoin$RepID <- split[[1]][3]\n  master <- bind_rows(master, toJoin)\n}\n\nmaster$Genotype <- as.factor(master$Genotype)\nmaster$RepID <- as.factor(master$RepID)\n\ncalculateFracMono <- function(labels){\n  mono <- sum(labels == \"monoallelic\") + sum(labels == \"IGF2+\")\n  total <- mono + sum(labels == \"biallelic\")\n  return(mono/total)\n}\n\nmaster <- master %>% group_by(isTreated, Genotype, RepID) %>% mutate(fracMono = calculateFracMono(AllelicExpression))\n\nmaster_9CG <- filter(master, Genotype == \"9CG\") %>% mutate(Condition = ifelse(isTreated, \"Drug\", \"Control\"))\nmaster_9CG_forPlot <- master_9CG %>% group_by(RepID, Condition, Genotype) %>% summarise(fracMono = unique(fracMono))\n \n\nmaster_WT <- filter(master, Genotype == \"WT\") %>% mutate(Condition = ifelse(isTreated, \"Drug\", \"Control\"))\nmaster_WT_forPlot <- master_WT %>% group_by(RepID, Condition, Genotype) %>% summarise(fracMono = unique(fracMono))\n\np5 <- ggplot() +\n  geom_point(data= master_WT_forPlot, aes(x= Condition, y = fracMono, size = 3)) +\n  geom_line(data= master_WT_forPlot, aes(x= Condition, y = fracMono, group = RepID)) +\n  ylim(c(0,1)) +\n  theme_bw(base_size = 12, base_family = \"Helvetica\") +\n  ggtitle(\"WT MEF Monoallelc fraction in Response to 5-AZA treatment\")\nplot(p5)\nsetwd(outSelectdir)\nggsave(plot = p5,  width = 8, height = 9,   filename =  paste(\"WT_MEF_5_AZA.pdf\", sep = \"_\"))\nsetwd(currdir)\n\np5 <- ggplot() +\n  geom_point(data= master_9CG_forPlot, aes(x= Condition, y = fracMono, size = 3)) +\n  geom_line(data= master_9CG_forPlot, aes(x= Condition, y = fracMono, group = RepID)) +\n  ylim(c(0,1)) +\n  theme_bw(base_size = 12, base_family = \"Helvetica\") +\n  ggtitle(\"9CG MEF Monoallelc fraction in Response to 5-AZA treatment\")\nplot(p5)\nsetwd(outSelectdir)\nggsave(plot = p5,  width = 8, height = 9,   filename =  paste(\"MUT_MEF_5_AZA.pdf\", sep = \"_\"))\nsetwd(currdir)\n\n\nmaster_forPlot <- master %>% mutate(Condition = ifelse(isTreated, \"Drug\", \"Control\")) %>% group_by(RepID, Condition, Genotype) %>%\n  summarise(fracMono = unique(fracMono))\n\np6 <- ggplot() +\n  geom_point(data= master_forPlot, aes(x= Condition, y = fracMono, colour = Genotype, shape = RepID, size = 3)) +\n  geom_line(data= master_WT_forPlot, aes(x= Condition, y = fracMono, group = RepID, color = Genotype)) +\n  geom_line(data= master_9CG_forPlot, aes(x= Condition, y = fracMono, group = RepID, color = Genotype)) +\n  ylim(c(0,1)) +\n  theme_bw(base_size = 12, base_family = \"Helvetica\") +\n  ggtitle(\"MEF Monoallelc fraction in Response to 5-AZA treatment\")\nplot(p6)\n\nsetwd(outSelectdir)\nggsave(plot = p6,  width = 8, height = 9,   filename =  paste(\"MEF_5_AZA.pdf\", sep = \"_\"))\nsetwd(currdir)\n\n\np7 <- ggplot() +\n  geom_point(data= master_forPlot, aes(x= Condition, y = fracMono, colour = Genotype, shape = RepID, size = 3)) +\n  scale_shape_discrete(solid=F) +\n  ylim(c(0,1)) +\n  theme_bw(base_size = 12, base_family = \"Helvetica\") +\n  ggtitle(\"MEF Monoallelc fraction in Response to 5-AZA treatment\")\nplot(p7)\n\nsetwd(outSelectdir)\nggsave(plot = p7,  width = 8, height = 9,   filename =  paste(\"MEF_5_AZA_noLine.pdf\", sep = \"_\"))\nwrite.csv(master_forPlot, \"5-azaD_Drug Experiment.csv\")\nsetwd(currdir)\n\n##STATISTICS\n\nt.test(master_9CG_forPlot$fracMono~master_9CG_forPlot$Condition == 'Control')\n\nmaster_9CG_forPlot$fracMono\nmaster_9CG_forPlot$Condition\n\n",
    "created" : 1449175788966.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2274553648",
    "id" : "E35D6FE9",
    "lastKnownWriteTime" : 1449176090,
    "path" : "/Volumes/SNPFISH_H19/H19 SNP-FISH Paper/Scripts/makeFigure4.R",
    "project_path" : "makeFigure4.R",
    "properties" : {
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "type" : "r_source"
}